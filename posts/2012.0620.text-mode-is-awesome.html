<!doctype html>
<html>
<head>
<meta charset='utf-8'/>
<style>
/* Blog stylesheet | Spencer Tipping*/
/* Licensed under the terms of the MIT source code license*/

body {font-family: 'Sans', sans-serif; font-size: 9pt; line-height: 1.44em; margin: 0 auto; max-width: 80ex}

a {color: #35a; text-decoration: none}
a:hover {text-decoration: underline}
a:visited {color: #89a}

#header {position: absolute; right: 0; top: 0; padding: 10px; text-align: right; font-size: 8pt}
#header h3 {font-size: 8pt; font-weight: normal}
#header ul {list-style-type: none}

#contents {padding: 10px 0}
#contents h1, #contents h2, #contents h3, #contents h4 {font-weight: normal; font-size: 14pt; text-transform: lowercase; margin: 0; padding: 10px 0}
#contents h2 {font-size: 10pt; color: #000; text-transform: uppercase}
#contents h3 {font-size: 10pt; color: #444; text-transform: uppercase} #contents h3:before {content: '> '; color: #888}
#contents h4 {font-size: 10pt; color: #888; text-transform: uppercase} #contents h4:before {content: '> '; color: #ccc}

#contents em {color: #444}

#contents .date      {color: #888; font-size: 10pt; font-family: 'Droid Sans Mono', 'Monospace', 'Liberation Mono', monospace; float: right; margin-top: 1em}
#contents .permalink {font-size: 10pt; float: right; margin-top: 1em}
#contents .permalink a {color: #888}
#contents .permalink a:after {color: #ccc; content: '|'}

td, th {text-align: right; border-right: solid 1px #ccc}

/* Generated by SDoc */

</style>
<link rel='alternate' href='feed.atom' type='application/atom+xml' title='Atom feed'/>
</head>
<body>
<div id='header' role='banner'>
<div><a href='http://twitter.com/spencertipping' aria-label='Twitter handle'>@spencertipping</a></div>
<div><a href='http://github.com/spencertipping' aria-label='Github profile'>github.com/spencertipping</a></div>
<div><a href='http://github.com/spencertipping/plain-blog'>Blog source</a></div>
<div><a href='http://spencertipping.com/zeroconsulting'>Zero-risk consulting</a></div>
<div><a href='http://spencertipping.com/feed.atom'>Atom feed</a></div>

<h3><label for='family'>Family</label></h3>
<ul id='family'>
<li><a href='http://joycetipping.com'>Joyce (my wife)</a></li>
<li><a href='http://adamtipping.com'>Adam (our son)</a></li>
</ul>

<h3><label for='projects'>Projects</label></h3>
<ul id='projects'>
<li><a href='http://github.com/spencertipping/cd'>cd</a></li>
<li><a href='http://github.com/spencertipping/perl-objects'>Self-modifying Perl</a></li>
<li><a href='http://github.com/spencertipping/flotsam'>Flotsam</a></li>
<li><a href='http://github.com/spencertipping/js-instabench'>Javascript Instabench</a></li>
<li><a href='http://spencertipping.com/cheloniidae'>Cheloniidae</a></li>
<li><a href='http://github.com/spencertipping/sdoc'>SDoc</a></li>
<li><a href='http://github.com/spencertipping/bash-prompt'>Bash prompt</a></li>
<li><a href='http://github.com/spencertipping/rather-insane-serialization'>Rather Insane Serialization</a></li>
<li><a href='http://github.com/spencertipping/infuse'>Infuse JS</a></li>
<li><a href='http://github.com/spencertipping/browserpower'>Browserpower</a></li>
<li><a href='http://github.com/spencertipping/perlquery'>Perlquery</a></li>
<li><a href='http://github.com/spencertipping/cheloniidae-live'>Cheloniidae Live</a></li>
</ul>

<h3><label for='moreprojects'>Misguided but fun</label></h3>
<ul id='moreprojects'>
<li><a href='http://github.com/spencertipping/canard'>Canard</a></li>
<li><a href='http://github.com/spencertipping/caterwaul'>Caterwaul JS</a></li>
<li><a href='http://github.com/spencertipping/bash-lambda'>Bash-lambda</a></li>
<li><a href='http://github.com/spencertipping/catastrophe'>Catastrophe</a></li>
<li><a href='http://github.com/spencertipping/mulholland'>Mulholland</a></li>
</ul>

<h3><label for='quizzes'>Web quizzes</label></h3>
<ul id='quizzes'>
<li><a href='http://spencertipping.com/pl-quiz.html'>Programming language quiz</a></li>
<li><a href='http://spencertipping.com/js-quiz.html'>Javascript quiz</a></li>
</ul>

<h3><label for='pdfs'>PDFs</label></h3>
<ul id='pdfs'>
<li><a href='http://github.com/spencertipping/js-in-ten-minutes'>Javascript in Ten Minutes</a></li>
<li><a href='http://github.com/spencertipping/writing-self-modifying-perl'>Writing Self-Modifying Perl</a></li>
<li><a href='http://github.com/spencertipping/git-in-ten-minutes'>Git in Ten Minutes</a></li>
<li><a href='http://caterwauljs.org/doc/caterwaul-by-example.pdf'>Caterwaul by Example</a></li>
<li><a href='http://caterwauljs.org/doc/caterwaul-reference-manual.pdf'>Caterwaul Reference Manual</a></li>
<li><a href='http://spencertipping.com/cheloniidae/cheloniidae.pdf'>Cheloniidae literate source</a></li>
<li><a href='http://spencertipping.com/mathbio2008/model.pdf'>MathBio model literate source</a></li>
</ul>

<h3><label for='jquery-modules'>jQuery modules</label></h3>
<ul id='jquery-modules'>
<li><a href='http://github.com/spencertipping/modus'>Modus (uses Caterwaul)</a></li>
<li><a href='http://github.com/spencertipping/jquery.instavalidate'>Instavalidate</a></li>
<li><a href='http://github.com/spencertipping/jquery.gaussian'>Gaussian blur</a></li>
<li><a href='http://github.com/spencertipping/jquery.fix.clone'>clone() patch</a></li>
</ul>

<h3><label for='caterwaul-modules'>Caterwaul modules</label></h3>
<ul id='caterwaul-modules'>
<li><a href='http://github.com/spencertipping/caterwaul-bloom'>Bloom filters</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-struct'>C struct binary I/O</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-heap'>Heap</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-numeric'>Vector math</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-serialization'>Reference-safe serialization</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-regexp'>Regular expression parser</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-parser'>Nonlinear parser combinators</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-invariant'>Invariant state propagation</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-futures'>Future monad</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-factory'>Value production combinators</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-jquery-node'>Headless jQuery renderer</a></li>
</ul>

<h3><label for='college-projects'>College projects</label></h3>
<ul id='college-projects'>
<li><a href='http://github.com/spencertipping/mathbio2008'>MathBio summer research (2008)</a></li>
<li><a href='http://github.com/spencertipping/mcm2007'>MAA Mathematical contest in modeling (2007)</a></li>
</ul>

<h3><label for='questionable-ideas'>Questionable Ideas</label></h3>
<ul id='questionable-ideas'>
<li><a href='http://github.com/spencertipping/cpp-template-lisp'>Lisp in C++ templates</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-ext4'>Caterwaul ext4 filesystem driver</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-ruby'>Caterwaul Ruby syntax module</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-terminal'>Caterwaul ANSI terminal module</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-reflection'>Caterwaul deep reflection module</a></li>
<li><a href='http://github.com/spencertipping/caterwaul.hlasm'>Caterwaul 0.x high-level assembler</a></li>
<li><a href='http://github.com/spencertipping/caterwaul.llasm'>Caterwaul 0.x low-level assembler</a></li>
<li><a href='http://github.com/spencertipping/rift'>Rift Ruby VM</a></li>
<li><a href='http://github.com/spencertipping/delimited-continuations-in-scheme'>Delimited continuations in Scheme</a></li>
<li><a href='http://github.com/spencertipping/instaserver'>Instaserver</a></li>
<li><a href='http://github.com/spencertipping/havoc'>Havoc programming language</a></li>
<li><a href='http://github.com/spencertipping/node-runabuf'>node.js run-a-buf</a></li>
<li><a href='http://github.com/spencertipping/js-typeclasses'>Javascript dynamic typeclasses</a></li>
</ul>

<h3><label for='epic-failures'>Epic Failures</label></h3>
<ul id='epic-failures'>
<li><a href='http://github.com/spencertipping/caterwaul-hijack'>Caterwaul parser hijack module</a></li>
<li><a href='http://github.com/spencertipping/caterwaul-c'>Caterwaul C syntax module</a></li>
<li><a href='http://github.com/spencertipping/divergence'>Divergence</a></li>
<li><a href='http://github.com/spencertipping/divergence.rebase'>Divergence Rebase</a></li>
<li><a href='http://github.com/spencertipping/gnarly'>Gnarly programming language</a></li>
<li><a href='http://github.com/spencertipping/figment'>Figment programming language</a></li>
<li><a href='http://github.com/spencertipping/montenegro'>Montenegro</a></li>
</ul>

<!-- Generated by SDoc -->

</div>

<div id='contents' role='main'>
<div id='post-2012.0620-text-mode-is-awesome'>
  <span class='date'>2012.0620</span>
  <span class='permalink'><a href='/posts/2012.0620.text-mode-is-awesome.html'>permalink</a></span>
  <div class='section level1'>
  <h1>Text-mode is awesome</h1>
  <p>I recently tweeted that (text : GUI) :: (FP : OOP), and that Vim was a WYSIWYG
version of Ed. I've been thinking a lot about how UIs are structured, more
computationally than visually, so I'm interested in analogies like these. This
post is a rambling collection of thoughts around the philosophical differences
between text and GUIs.</p>
  <div class='section level2'>
    <h2>The obligatory anecdote</h2>
    <p>  I <a href='http://en.wikipedia.org/wiki/Wikipedia:Database_download'
 >downloaded Wikipedia</a> the other day. Now I've got 8GB of
  bzipped XML that I need to unpack and index into articles so I can pull them
  up in <code>less</code> or <code>vim</code>. I wanted to see how the XML was
  structured, so I did this:</p>
    <pre class='quoted'>$ bzcat wikipedia.xml.bz2 | less</pre>
    <p>  And magically, everything Just Worked (keep in mind that I'm using a
  two-year-old netbook with 1GB of memory). No swapping to disk. No significant
  delay at all. And, remarkably, no CPU usage until I scrolled or searched the
  document. I saw the first screenful of XML in well under a second.</p>
    <p>  UNIX/Linux users, will, of course, not be at all surprised by this because the
  pipe has worked this way since the Middle Ages. But a large segment of the
  computing world doesn't have the ability to slice 8GB of data so elegantly.
  For example, suppose the Wikipedia data were stored in 34GB of HTML, similarly
  bzipped, and we wanted to view it in a browser. No problem, we'll just do
  this:</p>
    <pre class='quoted'>$ bunzip2 wikipedia.html.bz2 &amp;      # Or worse, use WinZIP :)
$ google-chrome ./wikipedia.html</pre>
    <p>  Aside from the obvious issue that Chrome is likely to load the file faster
  than bunzip2 can provide data, there's a bigger problem lurking here. Suppose
  you've loaded up the first screenful of HTML. Does Chrome wait before reading
  the rest of the document?</p>
    <p>  Of course not. It can't, because HTML has no locality properties at all. You
  could easily put a script like this at the bottom:</p>
    <pre class='quoted'>&lt;script&gt;document.body.innerHTML = ''&lt;/script&gt;</pre>
    <p>  The problem here is that the document has a mutable model with no spatial
  ordering of elements. The only way to accurately render the document is to
  load the whole thing into memory, run the scripts, and then render the subset
  of components that appear on the screen (which itself is no small task).</p>
    <p>  Put differently, a function from time to state, for any element in the
  document, is both Turing-complete and requires a complete model of the entire
  document.</p>
  </div>
  <div class='section level2'>
    <h2>FP and OOP</h2>
    <p>  FP generally emphasizes data transformations that are extrinsic to the data
  itself, and elements of data are generally immutable and unencapsulated. OOP
  tends towards the opposite: transformations are intrinsic, data is generally
  mutable, and state is hidden.</p>
    <p>  This difference is crucial to the function of shell pipes. Once
  <code>bunzip2</code> writes a byte to stdout, it has no way to change it or
  impact the state of that byte. All interpretation is left to the next process.</p>
    <p>  The real power comes from the way ASCII is interpreted. Text streams have a
  spatial ordering that, aside from ANSI escape codes and backspace characters,
  maps directly onto the order of bytes in the input. This wouldn't be true if
  ASCII also defined a 'previous-line' character (I'll call it <code>\p</code>).
  For example:</p>
    <pre class='quoted'>foo\nbar -&gt; foo
            bar</pre>
    <pre class='quoted'>foo\nbar\pbif -&gt; bif
                 bar</pre>
    <p>  The problem with <code>\p</code> is that it breaks the ordering. This forces
  interpreters like <code>less</code> to provide a mutable data model, which in
  turn requires them to load the entire input stream before displaying anything.</p>
  </div>
  <div class='section level2'>
    <h2>IO</h2>
    <p>  Since bytes have no intrinsic data transformations or hidden state, they have
  no identity; the byte <code>65</code> (capital A in ASCII) is the same
  regardless of whether it comes from a file, the network, or, importantly, the
  keyboard. This last point is where things get interesting.</p>
    <p>  Suppose you're doing stuff on the command line and get tired of repeating
  yourself. Maybe you're sending a series of requests to a webserver:</p>
    <pre class='quoted'>$ curl http://server/request1
$ curl http://server/request2
...</pre>
    <p>  It's insanely easy to store this process. You can just send your commands to a
  file rather than to a shell:</p>
    <pre class='quoted'>$ cat &gt; commands
curl http://server/request1
curl http://server/request2
...
^D</pre>
    <p>  Then you can replay them using a redirection:</p>
    <pre class='quoted'>$ bash &lt; commands</pre>
    <p>  Boring, right? We've seen all this already. Okay, so why can't we do the same
  thing with a web browser?</p>
    <p>  The obvious answer is that we could, it would just involve replaying a series
  of browser-generated events. But with sites doing A/B testing and what-not,
  those events wouldn't necessarily mean the same thing. A click could go to the
  wrong place if the layout changed even by a few pixels.</p>
    <p>  The real problem is that the events themselves contain implicit ties to the
  DOM state, which I've mentioned requires a Turing-complete simulation and is
  not fully initialized until all of the data has been read. Events are
  generated by an implementation-specific process, and because the model has
  hidden state it is unclear how much data will be required to emulate it.</p>
    <p>  By the way, you can always get to a DOM-style model for text. All you have to
  do is start piping things into <code>ed</code>. At that point you'll have an
  in-memory representation of the document so that you can use random access,
  mutation, and other features that aren't normally supported by the streaming
  pattern. The advantage of this is that you can then export the result back to
  a stream and continue using the same old tools.</p>
  </div>
  <div class='section level2'>
    <h2>Programming languages</h2>
    <p>  Strangely enough, I think the philosophy behind FP is better represented by
  shell programming than it is by functional programming languages. FP languages
  still have a number of strange quirks, most notably that you can't generally
  serialize values even though technically every value is anonymous. The reasons
  for this tend to be arcane -- stuff like holding references to opaque
  structures within the language runtime -- but still relevant for real-world
  use.</p>
    <p>  The UNIX command-line toolset is remarkably analogous to functional
  programming in any case. For example:</p>
    <pre class='quoted'>grep 'pattern' file         -&gt; filter f xs
head -n100 file             -&gt; take 100 xs
tail -n100 file     sort of -&gt; drop n xs</pre>
    <p>  The similarity goes beyond commands; data structures are also modeled:</p>
    <pre class='quoted'>mkdir foo                   -&gt; foo = {}
echo bif &gt; foo/bar          -&gt; foo['bar'] = ['bif']
echo baz &gt;&gt; foo/bar         -&gt; foo['bar'].push('baz')</pre>
    <p>  Conveniently, newlines give us seamless Perl-style lists with associative
  consing. That is, a scalar (a one-line file) is just a one-element array (a
  many-line file). This means that files generalize a couple of different
  monads (<code>Maybe</code> and <code>List</code> are the ones that come to
  mind) and allow us to freely convert between them since the types are erased
  by the time we use the data.</p>
  </div>
  <div class='section level2'>
    <h2>The image</h2>
    <p>  Continuing the now off-topic tangent, I'd like to point out that an image of a
  hard disk is, as its name suggests, an image. And Bash is, as its name sort of
  suggests, a REPL, which is a kind of shell.</p>
    <p>  Therefore, using a shell to modify a hard disk image when writing software is
  very similar to using a REPL to modify an image file, something you might do
  in Smalltalk or Lisp. A lot of developers are understandably leery of this
  paradigm because it's hard to see what has been defined, diffing is difficult,
  etc. In general I would argue that the UNIX image and REPL are much more
  powerful and functional than the REPLs offered by other languages -- that
  could be why we're willing to work with it but unwilling to use other
  image-based systems. But the analogy is still there, and the power of a
  self-modifying image is sufficient that nobody edits a disk image from the
  outside anymore.</p>
  </div>
  <div class='section level2'>
    <h2>Complexity</h2>
    <p>  Last sub-point. UNIX command-line tools are small and have very few bugs,
  graphical programs are large and have many more bugs. This echoes the claims
  made by FP advocates that functional code is simpler to write and maintain.
  The 200+ megabyte Haskell installation is not a great testament to this point,
  but the difference between Chrome (70MB) and <code>less</code> (151KB) could
  be, depending on how you interpret it.
</p>
  </div>
</div>
</div>

</div>
</body>
</html>
